{
  "schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
  "actions": {
    "quarantine_file": {
      "type": "Microsoft.Sentinel/quarantineFile",
      "inputs": {
        "filePath": "@triggerBody()?['FilePath']",
        "machineId": "@triggerBody()?['MachineId']"
      }
    },
    "notify_team": {
      "type": "SendEmail",
      "inputs": {
        "emailAddress": "securityteam@company.com",
        "subject": "Malware Detected",
        "body": "A malware file has been detected and quarantined on the following machine: @triggerBody()?['MachineId']."
      }
    },
    "create_incident": {
      "type": "ServiceNow/createIncident",
      "inputs": {
        "shortDescription": "Malware detected and quarantined",
        "priority": "1",
        "details": "@triggerBody()?['Description']"
      }
    }
  },
  "triggers": {
    "MalwareAlert": {
      "type": "Microsoft.Sentinel/alert",
      "inputs": {
        "severity": "High",
        "category": "Malware"
      }
    }
  }
}
